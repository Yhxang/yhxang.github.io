<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>海信世界杯球迷广场</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1, minimum-scale=1, user-scalable=no">
    <link href="css/swiper-3.4.2.min.css" rel="stylesheet">
    <link href="css/style.css?ver=1.33" rel="stylesheet">
</head>
<body>
<div id="wrap">
    <div class="section p0">
        <div class="p0-center">
            <div class="p0-football">
                <img src="img/a75.png" alt="" class="p0-footballimg">
            </div>
            <img src="img/a76.png" alt="" class="p0-shadow">
            <p class="p0-pct">0%</p>
        </div>
    </div>
    <div class="section p1">
        <img data-src="img/a04.png" alt="" class="p1-photo1">
        <img data-src="img/a05.png" alt="" class="p1-photo2">
        <img data-src="img/a06.png" alt="" class="p1-photo3">
        <img data-src="img/a08.png" alt="" class="p1-flag">
        <div class="p1-tvarea">
            <img data-src="img/a07.png" alt="" class="p1-tv">
            <div class="p1-tvscr"></div>
        </div>
        <div class="p1-tiparea">
            <img data-src="img/a10.png" alt="" class="p1-arr">
            <img data-src="img/a11.png" alt="" class="p1-tip">
        </div>
        <div class="p1-handarea">
            <img data-src="img/a09.png" alt="" class="p1-hand">
        </div>
        <img data-src="img/a03.png" alt="" class="p1-light">
        <img data-src="img/a01.png" alt="" class="p1-logo">
    </div>
    <div class="section p3 small">
        <img data-src="img/a32.png" alt="" class="p3-bg lt50p">
        <div class="p3-maparea lt50p">
            <div class="p3-bikemask">
                <div class="p3-bikemove">
                    <div class="p3-bike"></div>
                </div>
            </div>
        </div>
        <div class="p3-btnarea lt50p">
            <img data-src="img/a30.png" alt="" class="p3-startBtn">
        </div>
        <img data-src="img/a22.png?ver=1" alt="" class="p3-rule">
        <img data-src="img/a23.png?ver=1" alt="" class="p3-intro">
        <div class="p3-black wh100p">
            <div class="p3-msgarea2 lt50p p3-msg">
                <img data-src="img/a28.png" alt="" class="p3-msgtxt2">
                <img data-src="img/a25.png" alt="" class="p3-close">
            </div>
            <div class="p3-msgarea3 lt50p p3-msg">
                <img data-src="img/a29.png" alt="" class="p3-msgtxt3">
                <img data-src="img/a25.png" alt="" class="p3-close">
            </div>
        </div>

        <div class="p3-cover wh100p"></div>
        <div class="p3-white wh100p"></div>
    </div>
    <div class="section p4" id="mapsection">
        <div class="mapHolder wh100p" id="mapHolder">
            <div class="map" id="map">
                <img data-src="img/map.jpg" alt="">
                <div class="cupstar"></div>
                <div class="haluo"></div>
                <div class="screen"></div>
                <div class="photo"></div>
                <div class="perr">
                    <img data-src="img/a73.png" class="perrbg" alt="" />
                    <img data-src="img/a74.png" class="perrtxt" alt="" />
                </div>
            </div>
        </div>
        <div class="p4-tip wh100p">
            <div class="p4-tipbox lt50p">
                <img data-src="img/a81.png" alt="" class="p4-tipbg">
                <img data-src="img/a27.png" alt="" class="p4-tipbtn lt50p">
            </div>
        </div>
    </div>

    <div class="section p2">
        <div class="p2-cardarea lt50p">
            <img data-src="img/a35.png" alt="" class="p2-cardbg">
            <div class="p2-cardA p2-cards wh100p">
                <img data-src="img/a43.png" alt="" class="p2-puzzle">
                <img data-src="img/a36.png" alt="" class="p2-card p2-card1">
                <img data-src="img/a37.png" alt="" class="p2-card p2-card2">
                <img data-src="img/a38.png" alt="" class="p2-card p2-card3">
                <img data-src="img/a39.png" alt="" class="p2-card p2-card4">
                <img data-src="img/a40.png" alt="" class="p2-card p2-card5">
                <img data-src="img/a41.png" alt="" class="p2-card p2-card6">
                <img data-src="img/a42.png" alt="" class="p2-card p2-card7">
                <div class="wh100p p2-txts p2-txt1">
                    <p class="p2-title">恭喜您找到第<span class="idx">一</span>张球迷卡<br>这张卡来自携程旅行馆</p>
                    <p class="p2-detail">到海信线下球迷广场<br>体验由海信与携程为您提供的俄罗斯世界杯<br>吃喝玩乐出行娱乐咨询服务</p>
                </div>
                <div class="wh100p p2-txts p2-txt2">
                    <p class="p2-title">恭喜您找到第<span class="idx">二</span>张球迷卡<br>这张卡来自天籁之音馆</p>
                    <p class="p2-detail">“海信世界杯K歌争霸赛”火热进行中。<br>将作品上传至天籁K歌app活动页面即可参与比赛，<br>有机会赢取电视大奖</p>
                </div>
                <div class="wh100p p2-txts p2-txt3">
                    <p class="p2-title">恭喜您找到第<span class="idx">三</span>张球迷卡<br>这张卡来自足球萌宝馆</p>
                    <p class="p2-detail">“海信世界杯足球宝贝” 评选活动火热进行中，<br>关注海信电视微信公众号/宝宝树app，上传宝贝萌<br>照参加比赛，有机会赢取世界杯指定电视U7！</p>
                </div>
                <div class="wh100p p2-txts p2-txt4">
                    <p class="p2-title">恭喜您找到第<span class="idx">四</span>张球迷卡<br>这张卡来自有球必应馆</p>
                    <p class="p2-detail">到海信世界杯球迷广场，感受由海信与美团为您<br>共同呈现的智能生活服务新体验！</p>
                </div>
                <div class="wh100p p2-txts p2-txt5">
                    <p class="p2-title">恭喜您找到第<span class="idx">五</span>张球迷卡<br>这张卡来自FIFA足球世界馆</p>
                    <p class="p2-detail">电竞世界杯（6.14-7.15）海信战队全力出征。<br>关注海信微信公众号，为海信战队打call！！</p>
                </div>
                <div class="wh100p p2-txts p2-txt6">
                    <p class="p2-title">恭喜您找到第<span class="idx">六</span>张球迷卡<br>这张卡来自有颜任信馆</p>
                    <p class="p2-detail">使用美颜相机海信世界杯专属大片拍照功能及滤镜，<br>参与微博话题#有颜任信#，或参与“海信世界杯足<br>球宝贝”评选活动，有机会赢取世界杯指定电视U7！</p>
                </div>
                <div class="wh100p p2-txts p2-txt7">
                    <p class="p2-title">恭喜您找到第<span class="idx">七</span>张球迷卡<br>这张卡来自激光大屏观赛馆</p>
                    <p class="p2-detail">海信为您准备了世界杯观赛大屏产品 —— L5、L7<br>激光电视，超大视野，看球更爽！</p>
                </div>
                <img data-src="img/a34.png" alt="" class="p2-btn lt50p">

            </div>
            <div class="p2-cardB p2-cards">
                <p class="p2-title2">您已集齐所有散落的球迷卡！<br>快来预测世界杯冠军，并抽取好礼</p>
                <img data-src="img/a44.png" alt="" class="p2-fullimg">
                <img data-src="img/a45.png" alt="" class="p2-btn2 lt50p">
                <img data-src="img/a53.png" alt="" class="p2-btn3 lt50p">
            </div>
        </div>
    </div>
    <div class="section p6">
        <img data-src="img/a46.png" alt="" class="p6-bg wh100p">
        <p class="p6-tit">预测一下<br>哪支球队会成为世界杯冠军！</p>
        <div class="swiper-container">
            <div class="swiper-wrapper"></div>
            <div class="swiper-button-prev"></div>
            <div class="swiper-button-next"></div>
        </div>
        <img data-src="img/a52.png" alt="" class="p6-btn lt50p">
        <div class="p6-black wh100p">
            <div class="p6-box box lt50p">
                <p class="p6-boxtit">您选择的是<span class="p6-tname"></span>队</p>
                <p class="p6-txt2">如您选择的球队成为世界杯冠军<br>7月16日我们将会为您开启第二道抽奖通道</p>
                <div class="p6-linetxt"><p class="p6-txt3">敬请期待</p></div>
                <p class="p6-txt4">NOW，先去抽取您的本次集卡拼图奖品吧</p>
                <img data-src="img/a53.png" alt="" class="p6-btn2 lt50p">
            </div>
        </div>
    </div>

    <div class="section p5">
        <div class="p5-turntable lt50p">
            <img data-src="img/a19.png" alt="" class="p5-ground lt50p">
            <img data-src="img/a18.png" alt="" class="p5-turnshadow">
            <img data-src="img/a17.png" alt="" class="p5-turnbg lt100p">
            <img data-src="img/a14.png" alt="" class="p5-turn lt50p">
            <div class="p5-center lt50p">
                <img data-src="img/a13.png" alt="" class="p5-pointer">
                <img data-src="img/a12.png" alt="" class="p5-circ">
                <img data-src="img/a16.png" alt="" class="p5-fbshdow lt50p">
                <img data-src="img/a15.png" alt="" class="p5-football lt50p">
            </div>
            <img data-src="img/a21.png" alt="" class="p5-horn">
            <img data-src="img/a18.png" alt="" class="p5-fbshdow2">
            <img data-src="img/a20.png" alt="" class="p5-football2">
        </div>
    </div>
    <div class="section p7">
        <div class="p7-boxblue0 p7-bb lt50p">
            <p class="p7-err1 p7-err">每人每天只有三次抽奖机会哦！<br>明天再来试试运气吧！</p>
            <p class="p7-err2 p7-err">每个手机号只能获奖一次哦！<br>可以让朋友们来参与活动</p>
            <p class="p7-err3 p7-err">您还有<span id="p7-errnum3">2</span>次机会，<br>加油哦！</p>
            <p class="p7-err4 p7-err">对不起，<br>您已中过奖，谢谢！</p>
            <p class="p7-err5 p7-err">对不起，<br>活动时间已结束，谢谢！</p>
            <p class="p7-err6 p7-err">网络不给力<br>请重新点击转盘抽奖</p>
            <a href="javascript:void(0);" class="p7-link1 p-link lt50p">
                <img data-src="img/a69.png" alt="">
            </a>
            <img data-src="img/a52.png" alt="" class="p7-err3btn p7-err6btn lt50p">
        </div>
        <div class="p7-boxblue p7-bb lt50p">
            <h2 class="p7-txt1">恭喜您获得</h2>
            <p class="p7-awardname"></p>
            <img data-src="" alt="" class="p7-award1 lt50p">
            <img data-src="img/a48.png" alt="" class="p7-line1 lt50p">
            <p class="p7-txt2">您支持的球队将在7月16日<br>为您带来惊喜豪礼~记得回来抽奖噢！</p>
            <a class="p7-btn1 p7-btn lt50p" href="javascript:void(0);"><img data-src="img/a54.png" alt="" class="p7-btnimg"></a>
            <a class="p7-btn5 p7-btn lt50p my" href="https://h5.meitu.com/myxj_hisense/?utm_source=xianshang"><img data-src="img/a54.png" alt="" class="p7-btnimg"></a>
            <a class="p7-btn8 p7-btn lt50p mt" href="https://i.meituan.com/awp/hfe/block/931042656a5d686a12a4/8261/index.html"><img data-src="img/a54.png" alt="" class="p7-btnimg"></a>
        </div>
        <div class="p7-boxblue6 p7-bb lt50p">
            <h2 class="p7-txt1">恭喜您获得</h2>
            <p class="p7-awardname"></p>
            <img src="" alt="" class="p7-award1 lt50p">
            <div class="p7-codearea lt50p">
                <textarea readonly="readonly" class="p7-code" id="p7-code6">海信世界杯球迷广场</textarea>
                <div class="p7-copy">复制</div>
            </div>
            <img data-src="img/a48.png" alt="" class="p7-line1 lt50p">
            <a href="javascript:void(0);" class="p7-link p-link lt50p">
                <img data-src="img/a69.png" alt="">
            </a>
        </div>
        <div class="p7-boxblue9 p7-bb lt50p">
            <h2 class="p7-txt1">恭喜您获得</h2>
            <p class="p7-awardname"></p>
            <img src="" alt="" class="p7-award1 lt50p">
            <div class="p7-codearea lt50p">
                <textarea readonly="readonly" class="p7-code" id="p7-code9"></textarea>
                <div class="p7-copy">复制</div>
            </div>

            <img data-src="img/a48.png" alt="" class="p7-line1 lt50p">
            <a href="javascript:void(0);" class="p7-link p-link lt50p">
                <img data-src="img/a69.png" alt="">
            </a>
        </div>
        <div class="p7-boxblue10 p7-bb lt50p">
            <h2 class="p7-txt1">恭喜您获得</h2>
            <p class="p7-awardname"></p>
            <img src="" alt="" class="p7-award1 lt50p">
            <div class="p7-codearea lt50p">
                <textarea readonly="readonly" class="p7-code" id="p7-code10"></textarea>
                <div class="p7-copy">复制</div>
            </div>
            <img data-src="img/a48.png" alt="" class="p7-line1 lt50p">
            <a href="javascript:void(0);" class="p7-link p-link lt50p">
                <img data-src="img/a69.png" alt="">
            </a>
        </div>
    </div>
    <div class="section p8">
        <img data-src="img/a46.png" alt="" class="p8-bg wh100p">
        <p class="p8-tit">请填写下方联系方式<br>以便奖品顺利送到您手中</p>
        <img data-src="img/a48.png" alt="" class="p8-line lt50p">
        <div class="p8-form lt50p">
            <label for="username" class="p8-label">姓名</label>
            <input type="text" class="p8-input" id="username">
            <label for="address" class="p8-label">地址</label>
            <input type="text" class="p8-input" id="address">
            <label for="mobile" class="p8-label">手机号码</label>
            <input type="tel" maxlength="11" class="p8-input" id="mobile">
        </div>
        <img data-src="img/a72.png" alt="" class="p8-btn lt50p">
        <div class="p8-black wh100p">
            <div class="p8-boxblue0 p8-bb lt50p">
                <p class="p8-err1 p8-err">我们已经收到您的信息啦！<br>期待您赢取世界杯终极大奖哦！</p>
                <p class="p8-err2 p8-err">亲，您已参与过抽奖<br>知足常乐，莫要贪心哦~</p>
                <p class="p8-err3 p8-err">对不起，<br>活动时间已结束，谢谢！</p>
                <p class="p8-err4 p8-err">网络不给力<br>请重新提交您的信息</p>
                <a href="javascript:void(0);" class="p8-link p-link lt50p">
                    <img data-src="img/a69.png" alt="">
                </a>
                <img data-src="img/a78.png" alt="" class="p8-resub lt50p">
            </div>
        </div>
    </div>
    <div class="sndctrl"><i class="lt50p"></i></div>
</div>
<audio src="./media/bgm.mp3" loop="loop" autoplay="autoplay" preload="preload" id="bgm"></audio>
<script>
    var stageW=750,stageH,stageMaxH=1624,stageRate;
    stageRate=window.innerWidth/stageW;
    stageH=window.innerHeight*stageW/window.innerWidth;
    var wrap=document.getElementById("wrap");
    wrap.style.height=stageH+"px";
    wrap.style.webkitTransform="scale3d("+stageRate+","+stageRate+",1)";
    wrap.style.transform="scale3d("+stageRate+","+stageRate+",1)";
</script>
<script src="libs/jquery-3.0.0.min.js"></script>
<!-- <script src="http://res.wx.qq.com/open/js/jweixin-1.2.0.js"></script> -->
<script>
    var bgm=document.getElementById("bgm");
    function  audioAutoPlay(id){
        var audio = document.getElementById(id);
    
        if (window.WeixinJSBridge) {
            WeixinJSBridge.invoke('getNetworkType', {}, function (e) {
                audio.play();
            }, false);
        } else {
            document.addEventListener("WeixinJSBridgeReady", function () {
                WeixinJSBridge.invoke('getNetworkType', {}, function (e) {
                    audio.play();
                });
            }, false);
        }
        audio.play();
 
        return false;
    }
    audioAutoPlay("bgm");
    // window.onload = function(){
    //     var baseUrl = 'http://hisense.maimang.net.cn' + '/';
    //     var shareTitle = '来海信球迷广场，赢世界杯指定电视'; //分享朋友标题
    //     var shareDesc = ''; //分享朋友描述
    //     var tdesc = "来海信球迷广场，赢世界杯指定电视"; //分享朋友圈描述
    //     var shareImg = baseUrl + 'img/share.jpg'; //分享图片地址
    //     var shareLink = baseUrl + 'index.php'; //分享链接地址
    //     var ua = navigator.userAgent.toLowerCase();
    //     if (!(/micromessenger/.test(ua))) {
    //         return false; //not wechat
    //     }
    //     var wechatShare= function(title, desc, link, img, tdesc) {
    //         // 在这里调用 API
    //         wx.onMenuShareAppMessage({
    //             title: title,
    //             desc: desc,
    //             link: link,
    //             imgUrl: img,
    //             trigger: function (res) {
    //                 //alert('用户点击发送给朋友');
    //             },
    //             success: function (res) {
    //                 shareClick();
    //             },
    //             cancel: function (res) {
    //                 //alert('已取消');
    //             },
    //             fail: function (res) {
    //                 //alert(JSON.stringify(res));
    //             }
    //         });
    //         wx.onMenuShareTimeline({
    //             title: tdesc,
    //             link: link,
    //             imgUrl: img,
    //             trigger: function (res) {
    //                 //alert('用户点击分享到朋友圈');
    //             },
    //             success: function (res) {
    //                 shareClick();
    //             },
    //             cancel: function (res) {
    //                 //alert('已取消');
    //             },
    //             fail: function (res) {
    //                 // alert(JSON.stringify(res));
    //             }
    //         });
    //         wx.onMenuShareQQ({
    //             title: title,
    //             desc: desc,
    //             link: link,
    //             imgUrl: img,
    //             success: function () {
    //                 //shareClick();
    //             },
    //             cancel: function () {
    //             }
    //         });

    //         wx.onMenuShareWeibo({
    //             title: title,
    //             desc: desc,
    //             link: link,
    //             imgUrl: img,
    //             success: function () {
    //                 //shareClick();
    //             },
    //             cancel: function () {
    //             }
    //         });

    //         function shareClick() {
    //             console.log('share done');
    //         }
    //     }
    //     $.getScript("/index.php/activity/share?url=" + encodeURIComponent(window.location.href),function(){
    //         wx.config({
    //             debug: false,
    //             appId: nsJsApi.appId,
    //             timestamp:  nsJsApi.timestamp ,
    //             nonceStr: nsJsApi.nonceStr,
    //             signature: nsJsApi.signature,
    //             jsApiList: [
    //                 'checkJsApi',
    //                 'onMenuShareTimeline',
    //                 'onMenuShareAppMessage',
    //                 'onMenuShareQQ',
    //                 'onMenuShareWeibo',
    //                 'howOptionMenu',
    //                 'hideMenuItems',
    //                 'showMenuItems',
    //                 'hideAllNonBaseMenuItem',
    //                 'showAllNonBaseMenuItem'
    //             ]
    //         });
    //         wx.ready(function(){
    //             wechatShare(shareTitle, shareDesc, shareLink, shareImg, tdesc);
    //             bgm.play();
    //         });
    //         wx.error(function(res) {
    //             //alert(res);
    //         });
    //     });
    // }
</script>
<script src="libs/jquery.easing.1.3.js"></script>
<script src="libs/swiper-3.4.2.jquery.min.js"></script>
<script src="libs/hammer.min.js"></script>
<script>

    var config={
        chance: "2", //插入数据 演示处理
        betid: "0" //插入数据 演示处理
    }
    var data;//演示处理

    var betTurnAn=[15,345,315,285,255,195,165,135,45,105,75];
    var mySwiper;
    var manifest=[];
    var ver="1.1";
    for(var i=1;i<=11;i++){
        manifest.push("img/a"+(i<10?("0"+i):i)+".png?ver="+ver);
        var _i=i+10;
        manifest.push("img/a"+(_i<10?("0"+_i):_i)+".png?ver="+ver);
    }

    $(function(){
        loadResources(manifest,function(n,i,img){
            $(".p0-pct").html(Math.round(i * 100 / n) + "%");
            if (n != i) return;
            $("img").each(function(){
                var _src=$(this).data("src");
                if(_src){
                    $(this).attr("src",_src+"?ver="+ver);
                }
            })
            $(".p0").remove();
            $(".p1").show();
        })
        $(".p-link").attr("href","http://public.wxtv.hismarttv.com/weixintv/worldcup/qrcode?source=1&msgFlag=0&wcRedirectUrl=http://public.wxtv.hismarttv.com/weixintv/worldcup/web&hashvalue=/home&focusUrl=/showqrcode");
        if(config.betid!=0){//用户已经猜过球了
            $(".p2-btn3").show();
            $(".p2-btn2").hide();
        }
        $(".p1-handarea").one("click",function(){
            $(".p1-handarea").addClass("handflipY");
            $(".small").css({
                top:$(".p1-tvscr").offset().top/stageRate
            }).show();
            setTimeout(function(){
                $(".p3-bg,.p3-cover").show().height();
                $(".p3").removeClass("small").css({
                    top:0
                })
                $(".p3-cover").addClass("fadeOut");
                setTimeout(function(){
                    //$(".p3-black,.p3-msgarea1").show();
                    $(".p3-btnarea").show();
                },2000);
            },500)
        })
        $(".p3-close").click(function(){
            $(".p3-black,.p3-msg").hide();
        })
        $(".p3-close1,.p3-btn").click(function(){
            $(".p1").remove();
            $(".p3-black,.p3-msg").hide();
            $(".p3-btnarea").show();
        })

        $(".p3-intro").click(function(){
            $(".p3-black,.p3-msgarea2").show();
        })
        $(".p3-rule").click(function(){
            $(".p3-black,.p3-msgarea3").show();
        })
        $(".p3-startBtn").one("click",function(){
            $(".p3-maparea").show();
            $(".p3-startBtn").addClass("zoomOut");
            $(".p3").addClass("cammove");
            $(".p3").on("animationend webkitAnimationEnd",function(e){
                if($(e.target).hasClass("cammove")){
                    $(".p3").off().remove();
                }
            });
            setTimeout(function(){
                $(".p4").show();
            },3800)
        })
        var PointData=[
            {x:477,y:1925,cx:126,cy:316,brand:"xiecheng"},
            {x:920,y:1667,cx:227,cy:232,brand:"tianlai"},
            {x:185,y:1485,cx:434,cy:247,brand:"baobaoshu"},
            {x:705,y:1083,cx:365,cy:391,brand:"youqiubiying"},
            {x:248,y:593,cx:215,cy:456,brand:"dianjing"},
            {x:1095,y:599,cx:214,cy:576,brand:"meiyan"},
            {x:459,y:303,cx:437,cy:505,brand:"guansai"}
        ]
        var points=[];
        var cnindex=["零","一","二","三","四","五","六","七"];
        var cardno=0;
        function addPoint(){
            for(var i=0;i<PointData.length;i++){
                var p=$('<div class="point"></div>');
                p.css({left:PointData[i].x,top:PointData[i].y});
                p.addClass(PointData[i].brand);
                $(map).append(p);
                points.push(p);
                var FixPointW=parseInt($(".point").css("margin-left"));
                var FixPointH=parseInt($(".point").css("margin-top"));
                var FixHoldW=parseInt($(".p2-cardarea").css("margin-left"));
                var FixHoldH=parseInt($(".p2-cardarea").css("margin-top"));
                (function(n){
                    p.click(function(){
                        var sx=$(this).offset().left/stageRate-FixPointW-stageW*.5-FixHoldW;
                        var sy=$(this).offset().top/stageRate-FixPointH-stageH*.5-FixHoldH;
                        if(!$(this).hasClass("selected")){
                            ++cardno;
                            $(".p2,.p2-txt"+(n+1)).show().find(".idx").text(cnindex[cardno]);
                            var thiscard=$(".p2-card"+(n+1));
                            thiscard.css({
                                left:sx,
                                top:sy,
                                "-webkit-transform":"translateZ(0) scale3d(0,0,1) rotateX(-720deg) rotateY(720deg)",
                                "transform":"translateZ(0) scale3d(0,0,1) rotateX(-720deg) rotateY(720deg)"
                            }).show().height();
                            thiscard.css({
                                left:PointData[n].cx,
                                top:PointData[n].cy,
                                "-webkit-transform":"none",
                                "transform":"none"
                            });
                            var oldcard=$(".oldcard");
                            setTimeout(function(){
                                oldcard.css({opacity:1});
                            },1200);
                            thiscard.addClass("oldcard");
                        }else{

                            if($(this).hasClass("tianlai")||$(this).hasClass("meiyan")){
                                $(".perr").addClass("mirror");
                            }else{
                                $(".perr").removeClass("mirror");
                            }
                            $(".perr").hide().css({
                                left:parseInt($(this).css("left")),
                                top:parseInt($(this).css("top"))
                            }).show();
                        }
                        $(this).addClass("selected");
                    })
                })(i);
            }
        }
        $(".p2-btn").click(function(){
            if(cardno<7){
                $(".p2,.p2-txts").hide();
                $(".oldcard").css({opacity:0});
            }else{
                $(".p2-cardarea").addClass("flipX");
            }
        })
        $(".p2-btn2").click(function(){
            $(".p6").show();
            initTeam();
            initSwiper();
        })
        $(".p4-tipbtn").click(function(){
            $(".p4-tip").hide().remove();
        })
        var mc=new Hammer.Manager(document.getElementById("mapHolder"));
        mc.add(new Hammer.Pan({direction:Hammer.DIRECTION_ALL,threshold:0}))
        var mapW=1150,mapH=1999;
        var minX=stageW-mapW;
        var maxX=0;
        var minY=stageH-mapH;
        var maxY=0;
        var map=document.getElementById("map");
        $(map).css({left:minX/2,top:minY/2});
        var tarX=parseFloat($(map).css("left"));
        var tarY=parseFloat($(map).css("top"));

        addPoint();
        mc.on("panstart",function(ev){
            tarX=parseFloat($(map).css("left"));
            tarY=parseFloat($(map).css("top"));
            $(map).stop(true,false);
        })
        mc.on("pan",function(ev){
            var dX=ev.deltaX/stageRate;
            var dY=ev.deltaY/stageRate;
            if(tarX+dX>minX&&tarX+dX<maxX)
                map.style.left=tarX+dX+"px";
            if(tarY+dY>minY&&tarY+dY<maxY)
                map.style.top=tarY+dY+"px";
        })
        mc.on("panend",function(ev){
            tarX=parseFloat($(map).css("left"));
            tarY=parseFloat($(map).css("top"));
            var x=tarX+ev.velocityX*Math.pow(ev.velocity*2,2)*15;
            var y=tarY+ev.velocityY*Math.pow(ev.velocity*2,2)*15;
            if(x>maxX) x=maxX;
            if(x<minX) x=minX;
            if(y>maxY) y=maxY;
            if(y<minY) y=minY;
            var dis=Math.sqrt(Math.pow(x,2)+Math.pow(y,2));
            if(Math.abs(ev.velocity)>.5){
                $(map).animate({left:x,top:y},800,"easeOutQuint");
            }
        })

        var teams={
            A:["俄罗斯","沙特阿拉伯","埃及","乌拉圭"],
            B:["葡萄牙","西班牙","摩洛哥","伊朗"],
            C:["法国","澳大利亚","秘鲁","丹麦"],
            D:["阿根廷","冰岛","克罗地亚","尼日利亚"],
            E:["巴西","瑞士","哥斯达黎加","塞尔维亚"],
            F:["德国","墨西哥","瑞典","韩国"],
            G:["比利时","巴拿马","突尼斯","英格兰"],
            H:["波兰","塞内加尔","哥伦比亚","日本"]
        }
        function initTeam(){
            var dd_tpt='<dd data-id="{{teamid}}"><div class="flagarea"><div class="shadow"></div><div class="flagglow"></div><div class="flag" style="background-position:{{x}}px {{y}}px;"></div></div><p class="name">{{name}}</p></dd>';
            var dl_tpt='<dl data-team="{{team}}"><dt>{{teamUpper}} 组</dt>{{dds}}</dl>';
            var slide_tpt='<div class="swiper-slide">{{slide}}</div>';
            var teamidx=0;
            var dds_html=dls_html=swiper_html="";
            for(var i in teams){
                teamidx++;
                var dds_html='';
                var thisteam=teams[i];
                for(var j=0;j<thisteam.length;j++){
                    dds_html+=repalceTpt(dd_tpt,{
                        teamid:i.toLowerCase()+(j+1),
                        x:-(teamidx-1)*180,
                        y:-j*100,
                        name:thisteam[j]
                    });
                }
                dls_html+=repalceTpt(dl_tpt,{
                    team:i,
                    teamUpper:i,
                    dds:dds_html
                });
                if(teamidx%2==0){
                    swiper_html+=repalceTpt(slide_tpt,{
                        slide:dls_html
                    });
                    dls_html="";
                }
            }
            $(".swiper-wrapper").html(swiper_html);
            $("dd").click(function(e){
                $(".p6-btn").show();
                $(".active").removeClass("active");
                $(this).addClass("active");
            })
            function repalceTpt(tpt,obj){
                var _html=tpt;
                for(var i in obj){
                    _html= _html.replace(new RegExp("{{"+i+"}}","g"),obj[i]);
                }
                return _html;
            }
        }

        function initSwiper(){
            mySwiper = new Swiper ('.swiper-container', {
                nextButton: '.swiper-button-next',
                prevButton: '.swiper-button-prev'
            })
        }

        $(".p6-btn").click(function(){
            if(config.betid==0){
                config.betid=$(".active").data("id");
            }
            var flagclone= $(".active .flag").clone();
            $(".p6-box").append(flagclone);
            $(".p6-tname").text($(".active .name").text());
            $(".p6-black").show();
        })
        $(".p6-btn2,.p2-btn3").click(function(e){
            $(".p5").show();
            $(".p6-black").hide();
        })
        var awards=["不要灰心","世界杯指定电视U7","国际足球巨星签名足球","球星手办","聚好看月卡","美颜相机7张照片打印权益","携程旅行口令红包","国旗图案手机壳","美团优惠券","哈罗单车联名骑行月卡","天籁K歌京东50元代金券"];
        var clicktimes=0;
        var ajaxflag=1;
        $(".p5-center").click(function(){
            $(".p5-center").addClass("disabled");
            if(ajaxflag){
                ajaxSearch({
                    betid:config.betid
                },ajaxflag);
            }
        })
        function ajaxSearch($data,$flag){
            // $.ajax({
            //     url:"/index.php/activity/search_award",
            //     type:"post",
            //     data:$data,
            //     dataType:"json",
            //     beforeSend:function(){
            //         $flag = 0;
            //     },
                // success:function(data){
                    $flag = 1;

                    /*** 演示：仿ajax处理 ***/
                    if(!data){
                        data={result:1,code:"f1a2K3e4_c5o6D7e8",award:0,betsuc:1,chance:2};
                    }else{
                        if(--data.chance==1){//demo处理
                            data.award=Math.ceil(Math.random()*10);
                        }
                    }
                    console.log(data)
                    /*** 演示：仿ajax处理 ***/
                    
                    if(data.betsuc){
                        console.log("竞猜成功");
                    }else{
                        console.log("已经竞猜过");
                    }
                    if(1==data.result){
                        //console.log("disabled");
                        config.chance=parseInt(data.result);
                        config.awards=parseInt(data.award);//Math.ceil(Math.random()*11)-1;
                        config.code=data.code;
                        config.betsuc=data.betsuc;
                        console.log(config.awards+" ："+awards[config.awards]);
                        $(".test").text(awards[config.awards]);
                        $(".p7-awardname").text(awards[config.awards]);
                        $(".p7-award1").attr("src","./img/a"+(55+config.awards)+".png");
                        ++clicktimes;
                        betTurnAn[0]=Math.random()<.5?15:225;
                        var angle=-clicktimes*360*3;
                        var tgtAngle=betTurnAn[config.awards]-angle/3*5+(Math.random()*24-12);
                        $(".p5-turn").css({
                            "-webkit-transform":"rotateZ("+tgtAngle+"deg)",
                            "transform":"rotateZ("+tgtAngle+"deg)"
                        })
                        $(".p5-pointer").css({
                            "-webkit-transform":"rotateZ("+angle+"deg)",
                            "transform":"rotateZ("+angle+"deg)"
                        })
                        $(".p5-circ").removeClass("tandong");
                        $(".p5-football").removeClass("balldrop");
                        $(".p5-fbshdow").removeClass("shadowscale").height();
                        $(".p5-circ").addClass("tandong");
                        $(".p5-football").addClass("balldrop");
                        $(".p5-fbshdow").addClass("shadowscale");

                        $(".p5-turn").on("webkitTransitionEnd transitionend",function(){
                            $(".p7").show();//4s trans
                        })

                        $(".p7-bb,.p7-btn").hide();
                        if(0==config.awards){//没中奖
                            if(data.chance>0){//还有机会
                                $(".p7-link1,.p7-err").hide();
                                $(".p7-boxblue0,.p7-err3btn,.p7-err3").show();
                                $("#p7-errnum3").text(data.chance);
                            }else{
                                $(".p7-err3btn,.p7-err").hide();
                                $(".p7-boxblue0,.p7-err1,.p7-link1").show();
                            }
                        }else	if(6==config.awards){
                            $(".p7-boxblue"+config.awards).show().find(".p7-code").text("海信世界杯球迷广场");
                        }else	if(9==config.awards||10==config.awards){
                            $(".p7-boxblue"+config.awards).show().find(".p7-code").text(config.code);
                        }else if(5==config.awards||8==config.awards){
                            $(".p7-boxblue,.p7-btn"+config.awards).show();
                        }else{
                            $(".p7-boxblue,.p7-btn1").show();
                        }
                    }else if(-1==data.result){//机会用完
                        $(".p7-err3btn,.p7-err").hide();
                        $(".p7,.p7-boxblue0,.p7-err1,.p7-link1").show();
                    }else if(-2==data.result){//已经中过奖
                        $(".p7-err3btn,.p7-err").hide();
                        $(".p7,.p7-boxblue0,.p7-err4,.p7-link1").show();
                    }else if(-3==data.result){//活动时间已结束
                        $(".p7-err3btn,.p7-err").hide();
                        $(".p7,.p7-boxblue0,.p7-err5,.p7-link1").show();
                    }else if(0==data.result){//查询失败
                        $(".p7-link1,.p7-err").hide();
                        $(".p7-boxblue0,.p7-err6btn,.p7-err6").show();
                    }else{
                        alert("意外参数！")
                    }
                // },
            //     error:function(XMLHttpRequest, textStatus, errorThrown){
            //         $flag = 1;
            //         $(".p7-link1,.p7-err").hide();
            //         $(".p7,.p7-boxblue0,.p7-err6btn,.p7-err6").show();
            //     }
            // })
        }
        $(".p7-err3btn").click(function(){
            $(".p7,.p7-err3btn,.p7-err").hide();
            $(".p5-center").removeClass("disabled");
        })
        $(".p7-copy").click(function(){
            var obj=$(this).siblings(".p7-code")[0];
            obj.setSelectionRange(0,obj.value.length);
            obj.focus();
            document.execCommand('Copy');
        })
        $(".p7-btn1").click(function(e){
            e.preventDefault();
            $(".p8").show();
        })
        $(".p8-btn").click(function(){
            var username=$("#username").val();
            var address=$("#address").val();
            var mobile=$("#mobile").val();
            if(""==username.replace(/\s+/g,"")){
                alert("请输入姓名！");
                $("#username").focus();
            }else if(""==address.replace(/\s+/g,"")){
                alert("请输入地址！")
                $("#address").focus();
            }else if(""==mobile.replace(/\s+/g,"")){
                alert("请输入联系方式！");
                $("#mobile").focus();
            }else if(!/^\d{11}$/.test(mobile)){
                alert("请输入正确的手机号码！");
                $("#mobile").focus();
            }else{
                $(this).addClass("disabled");
                config.username=username;
                config.address=address;
                config.mobile=mobile;
                $(".p8-err").hide();
                if(ajaxflag){
                    submitForm({
                        username:username,
                        address:address,
                        mobile:mobile
                    },ajaxflag);
                }
            }
        })
        $(".p8-resub").click(function(){
            $(".p8-black,.p8-boxblue0,.p8-err").hide();
            if(ajaxflag){
                submitForm({
                    username:config.username,
                    address:config.address,
                    mobile:config.mobile
                })
            }
        })
        $(".sndctrl").click(function(){
            if(bgm.paused){//暂停状态
                bgm.play();
                $(".sndctrl").removeClass("muted");
            }else{
                bgm.pause();
                $(".sndctrl").addClass("muted");
            }
        })

    })
    function submitForm($data,$flag){
        // $.ajax({
        //     url:"/index.php/activity/submit_lucky",
        //     type:"post",
        //     data:$data,
        //     dataType:"json",
        //     beforeSend:function(){
        //         $flag = 0;
        //     },
        //     success:function(data){
                 $flag = 1;
        //         if(1==data.result){
                    $(".p8-resub").hide();
                    $(".p8-black,.p8-boxblue0,.p8-err1,.p8-link").show();
        //         }else if(-1==data.result){
        //             $(".p8-resub").hide();
        //             $(".p8-black,.p8-boxblue0,.p8-err2,.p8-link").show();
        //         }else if(-2==data.result){
        //             $(".p8-resub").hide();
        //             $(".p8-black,.p8-boxblue0,.p8-err3,.p8-link").show();
        //         }else if(0==data.result){
        //             $(".p8-link").hide();
        //             $(".p8-black,.p8-boxblue0,.p8-err4,.p8-resub").show();
        //         }else{
        //             alert("意外参数！");
        //         }
        //     },
        //     error:function(XMLHttpRequest, textStatus, errorThrown){
        //         $flag = 1;
        //         $(".p8-link").hide();
        //         $(".p8-black,.p8-boxblue0,.p8-err4,.p8-resub").show();
        //     }
        // })

    }
    function loadResources(urls, progress) {
        var loadedCount = 0;
        var loaded = function () {
            ++loadedCount;
            if (progress) progress(urls.length, loadedCount, this);
        };
        for (var i = 0; i < urls.length; ++i) {
            if (!urls[i]) {
                loaded();
                return;
            }
            var img = new Image();
            img.onload = loaded;
            img.onabort = loaded;
            img.onerror = loaded;
            img.src =  urls[i];
        }
    }
</script>
</body>
</html>